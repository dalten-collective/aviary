import{d as B,I as P,e as w,f as M,g as J,h as $,i as U,j as W,k as q,l as z,m as Q,n as Z,p as ee,q as se,s as oe,t as ne,u as te,v as le,x as ie,y as ce,z as _e,A as ae,B as re,C as Ie,D,E as de,F as Se,G as h,H as f,o as i,c as _,b as F,J as o,K as u,L as E,M as N,N as d,O as p,P as C,Q as R,R as k,S as ue}from"./index.4bc99584.js";import{s as Ee,a as O}from"./index.1c4e05d6.js";const Ne={availableChats:[],flocks:[],sentInvites:[],pendingInvites:[]};var x=(s=>(s.EXAMPLE_WITH_ARG="EXAMPLE_WITH_ARG",s))(x||{});const ve={[x.EXAMPLE_WITH_ARG]:s=>e=>"found it"};var r=(s=>(s.AVAILABLE_CHATS_SET="AVAILABLE_CHATS_SET",s.EXISTING_FLOCKS_SET="EXISTING_FLOCKS_SET",s.EXISTING_FLOCKS_ADD="EXISTING_FLOCKS_ADD",s.EXISTING_FLOCKS_REMOVE="EXISTING_FLOCKS_REMOVE",s.SENT_INVITES_SET="SENT_INVITES_SET",s.SENT_INVITES_ADD="SENT_INVITES_ADD",s.PENDING_INVITES_SET="PENDING_INVITES_SET",s))(r||{});const he={[r.AVAILABLE_CHATS_SET](s,e){s.availableChats=e},[r.EXISTING_FLOCKS_SET](s,e){s.flocks=e},[r.EXISTING_FLOCKS_ADD](s,e){s.flocks=s.flocks.concat(e)},[r.EXISTING_FLOCKS_REMOVE](s,e){s.flocks=s.flocks.filter(S=>{S.area})},[r.SENT_INVITES_SET](s,e){s.sentInvites=e},[r.SENT_INVITES_ADD](s,e){},[r.PENDING_INVITES_SET](s,e){s.pendingInvites=e}};var t=(s=>(s.AIRLOCK_OPEN="AIRLOCK_OPEN",s.FLOCK_FORM="FLOCK_FORM",s.FLOCK_DROP="FLOCK_DROP",s.FLOCK_JOIN="FLOCK_JOIN",s.INVITE_SEND="INVITE_SEND",s.INVITE_RESCIND="INVITE_RESCIND",s.SCRY_AVAIL_CHATS="SCRY_AVAIL_CHATS",s.SCRY_FLOKS="SCRY_FLOKS",s.SCRY_SENT_INVITES="SCRY_SENT_INVITES",s.SCRY_PENDING_INVITES="SCRY_PENDING_INVITES",s))(t||{});const Ce={[t.AIRLOCK_OPEN]({commit:s,dispatch:e},S){B.openAirlockTo(S,n=>{console.log("subscription response"),console.table(n),P(n)&&console.log("BlockedHosts ",n),w(n)&&(console.log("SentInvites ",n),s(r.SENT_INVITES_SET,n.fact)),M(n)&&(console.log("ExistingFlocks ",n),s(r.EXISTING_FLOCKS_SET,n.fact)),J(n)&&(console.log("AvailableChats ",n),s(r.AVAILABLE_CHATS_SET,n.fact)),$(n)&&(console.log("FlockStartFact ",n),s(r.EXISTING_FLOCKS_ADD,n.fact)),U(n)&&(console.log("FlockCeaseFact ",n),s(r.EXISTING_FLOCKS_REMOVE,n.fact)),W(n)&&(console.log("SendInvites ",n),s(r.SENT_INVITES_ADD,n.fact)),q(n)&&(console.log("InviteReceivedFact ",n),e(t.SCRY_PENDING_INVITES)),z(n)&&(console.log("PendingInvitesResponse ",n),s(r.PENDING_INVITES_SET,n.fact)),Q(n)&&(console.log("InviteAcceptedFact ",n),e(t.SCRY_FLOKS),e(t.SCRY_SENT_INVITES)),Z(n)&&(console.log("InviteRejectedFact ",n),e(t.SCRY_SENT_INVITES)),ee(n)&&(console.log("InviteRecindedFact ",n),e(t.SCRY_SENT_INVITES),e(t.SCRY_PENDING_INVITES)),se(n)&&(console.log("BirdLeftFact ",n),e(t.SCRY_FLOKS))},n=>{})},[t.FLOCK_FORM](s,e){return console.log("dispatching FLOCK_FORM action..."),oe(e)},[t.FLOCK_DROP](s,e){return console.log("dispatching FLOCK_DROP action..."),ne(e)},[t.FLOCK_JOIN](s,e){return console.log("dispatching FLOCK_JOIN action...",e),te(e)},[t.INVITE_SEND](s,e){return console.log("dispatching INVITE_SEND action..."),le(e)},[t.INVITE_RESCIND](s,e){return console.log("dispatching INVITE_RESCIND action..."),ie(e)},[t.SCRY_AVAIL_CHATS](s){return console.log("dispatching scry avail action..."),ce().then(e=>{console.log("scry ",e),s.commit(r.AVAILABLE_CHATS_SET,e.fact)})},[t.SCRY_FLOKS](s){return console.log("dispatching scry floks action..."),_e().then(e=>{console.log("scry ",e),s.commit(r.EXISTING_FLOCKS_SET,e.fact)})},[t.SCRY_SENT_INVITES](s){return console.log("dispatching scry sent action..."),ae().then(e=>{console.log("scry ",e),s.commit(r.SENT_INVITES_SET,e.fact)})},[t.SCRY_PENDING_INVITES](s){return console.log("dispatching scry pending action..."),re().then(e=>{console.log("scry ",e),s.commit(r.PENDING_INVITES_SET,e.fact)})}},Te=Ie({state:Ne,getters:ve,mutations:he,actions:Ce});function ge(){return Te}const fe={class:"mx-auto conatiner"},pe={class:"grid grid-cols-6 gap-1"},Fe={class:"col-span-4"},Re={class:"mb-4"},Oe=o("header",null,[o("h1",{class:"text-xl"}," flocks ")],-1),Le={key:0},Ve={key:1},me=o("h2",{class:"text-lg"},"birds:",-1),Ae={key:0},ke={class:"flex flex-row py-2 mt-2 border-t border-dashed"},De=["onClick"],xe={key:0,class:"px-2 py-1 ml-2 border rounded-md"},be={for:"inviteShip"},Ke={for:"inviteNote"},Ge=["placeholder"],Ye=["onClick"],ye={for:"area"},He={class:"flex flex-col col-span-2"},Xe={class:"mb-4"},je=o("header",null,[o("h1",{class:"text-xl"}," incoming invites ")],-1),Be={key:0},Pe={class:"p-2 my-4 border rounded-md"},we={class:"mb-2"},Me={class:"flex flex-col p-2 mb-2 border rounded-sm"},Je={class:"flex flex-row justify-between"},$e={class:"justify-end flex-flex row"},Ue={class:"text-right"},We=["onClick"],qe=["onClick"],ze={class:"mb-4"},Qe=o("header",null,[o("h1",{class:"text-xl"}," sent invites ")],-1),Ze={key:0},es={class:"p-2 my-4 border rounded-md"},ss={class:"mb-2"},os={class:"flex flex-row justify-between"},ns={class:"flex flex-col"},ts={class:"justify-end flex-flex row"},ls={class:"text-right"},is=["onClick"],cs=D({__name:"Start",setup(s){const e=ge();de(()=>{K("parrot"),e.dispatch(t.SCRY_SENT_INVITES)}),Se(()=>{});const S=h(""),n=h(""),v=h(""),T=h(""),g=h(""),L=f(()=>e.state.availableChats),V=f(()=>e.state.flocks),m=f(()=>e.state.sentInvites),A=f(()=>e.state.pendingInvites),b=I=>{const a=O(window.ship),l=I.host.split("/")[0];return a===O(l)},K=I=>{console.log("airlock"),e.dispatch(t.AIRLOCK_OPEN,I)},G=()=>{console.log("flocking ","ref: ",S.value," flag: ",n.value),e.dispatch(t.FLOCK_FORM,{area:S.value,chat:n.value}).then(()=>{e.dispatch(t.SCRY_FLOKS),e.dispatch(t.SCRY_AVAIL_CHATS)})},Y=I=>{console.log("dropping ","ref: ",I.area);const a=I.area;e.dispatch(t.FLOCK_DROP,{area:a}).then(()=>{e.dispatch(t.SCRY_AVAIL_CHATS)})},y=I=>{console.log("inviting ",[v.value]);const a=[v.value].map(l=>O(l));e.dispatch(t.INVITE_SEND,{area:I,note:T.value,ships:a}).then(()=>{v.value="",T.value="",e.dispatch(t.SCRY_SENT_INVITES)})},H=(I,a)=>{console.log("rescinding ",I,a),e.dispatch(t.INVITE_RESCIND,{area:I,ship:a}).then(()=>{e.dispatch(t.SCRY_SENT_INVITES)})},X=I=>{if(g.value===""){console.log("didnt choose a group");return}e.dispatch(t.FLOCK_JOIN,{host:I,join:g.value}).then(()=>{e.dispatch(t.SCRY_PENDING_INVITES),e.dispatch(t.SCRY_FLOKS)})},j=I=>{e.dispatch(t.FLOCK_JOIN,{host:I,join:null}).then(()=>{e.dispatch(t.SCRY_PENDING_INVITES)})};return(I,a)=>(i(),_("div",fe,[F(" birds "),o("div",pe,[o("div",Fe,[o("div",Re,[Oe,o("div",null,[u(V).length===0?(i(),_("div",Le," no flocks yet. form one. ")):(i(),_("ul",Ve,[(i(!0),_(E,null,N(u(V),l=>(i(),_("li",{key:l.area,class:"flex flex-col p-2 mb-2 border rounded-md"},[o("div",null,[o("div",null,[o("h1",null,'"'+d(l.area)+'"',1),o("h2",null,"host: "+d(l.host),1)]),o("div",null,[me,l.team.length===0?(i(),_("div",Ae," no birds yet. invite some birds to your flock. ")):p("",!0),o("ul",null,[(i(!0),_(E,null,N(l.team,c=>(i(),_("li",null,d(c),1))),256))])])]),o("div",ke,[o("button",{onClick:c=>Y(l)},"drop",8,De),b(l)?(i(),_("div",xe,[o("label",be,[C(o("input",{id:"inviteShip",placeholder:"~sampel-palnet","onUpdate:modelValue":a[0]||(a[0]=c=>v.value=c)},null,512),[[R,v.value]])]),o("label",Ke,[C(o("input",{id:"inviteNote",placeholder:`join my "${l.area}" flock`,"onUpdate:modelValue":a[1]||(a[1]=c=>T.value=c)},null,8,Ge),[[R,T.value]])]),o("button",{onClick:c=>y(l.area)},"invite",8,Ye)])):p("",!0)])]))),128))]))])]),o("div",null,[F(" new flock: "),o("div",null,[o("label",ye,[F(" area "),C(o("input",{id:"area",placeholder:"video-games","onUpdate:modelValue":a[2]||(a[2]=l=>S.value=l)},null,512),[[R,S.value]])]),C(o("select",{"onUpdate:modelValue":a[3]||(a[3]=l=>n.value=l)},[(i(!0),_(E,null,N(u(L),l=>(i(),_("option",{key:l},d(l),1))),128))],512),[[k,n.value]]),o("button",{onClick:G},"form")])])]),o("div",He,[o("div",Xe,[je,o("div",null,[u(A).length===0?(i(),_("div",Be," no incoming invites ")):p("",!0),o("ul",null,[(i(!0),_(E,null,N(u(A),l=>(i(),_("li",{key:l.host},[o("div",Pe,[o("header",we," chat: "+d(l.host),1),o("div",null,[o("div",Me,[o("div",Je,[o("div",null," area: "+d(l.invitation.area),1),o("div",null," on "+d(l.invitation.when),1)]),o("div",null,' note: "'+d(l.invitation.note)+'" ',1),o("div",$e,[o("div",Ue,[C(o("select",{"onUpdate:modelValue":a[4]||(a[4]=c=>g.value=c)},[(i(!0),_(E,null,N(u(L),c=>(i(),_("option",{key:c},d(c),1))),128))],512),[[k,g.value]]),o("button",{onClick:c=>X(l.host)},"join",8,We),o("button",{onClick:c=>j(l.host)},"ignore",8,qe)])])])])])]))),128))])])]),o("div",ze,[Qe,o("div",null,[u(m).length===0?(i(),_("div",Ze," no outgoing invites ")):p("",!0),o("ul",null,[(i(!0),_(E,null,N(u(m),l=>(i(),_("li",{key:l.area},[o("div",es,[o("header",ss,' "'+d(l.area)+'" area ',1),o("div",null,[(i(!0),_(E,null,N(l.invites,c=>(i(),_("div",{class:"flex flex-col p-2 mb-2 border rounded-sm",key:c.to},[o("div",os,[o("div",null," to: "+d(c.to),1),o("div",ns,[o("div",null,d(u(Ee)(c.invitation.when).toLocaleString()),1),o("div",null,d(c.status.status),1)])]),o("div",null,' note: "'+d(c.invitation.note)+'" ',1),o("div",ts,[o("div",ls,[o("button",{onClick:_s=>H(l.area,c.to)},"rescind",8,is)])])]))),128))])])]))),128))])])])])])]))}}),Is=D({__name:"ParrotHome",setup(s){return(e,S)=>(i(),ue(cs))}});export{Is as default};
